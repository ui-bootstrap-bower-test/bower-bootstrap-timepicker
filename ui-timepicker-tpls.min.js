angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(e,n,t,i,r,a){function s(){var n=parseInt(e.hours,10),t=e.showMeridian?n>0&&13>n:n>=0&&24>n;return t?(e.showMeridian&&(12===n&&(n=0),e.meridian===g[1]&&(n+=12)),n):void 0}function o(){var n=parseInt(e.minutes,10);return n>=0&&60>n?n:void 0}function u(e){return angular.isDefined(e)&&e.toString().length<2?"0"+e:e}function l(e){c(),h.$setViewValue(new Date(m)),d(e)}function c(){h.$setValidity("time",!0),e.invalidHours=!1,e.invalidMinutes=!1}function d(n){var t=m.getHours(),i=m.getMinutes();e.showMeridian&&(t=0===t||12===t?12:t%12),e.hours="h"===n?t:u(t),e.minutes="m"===n?i:u(i),e.meridian=m.getHours()<12?g[0]:g[1]}function p(e){var n=new Date(m.getTime()+6e4*e);m.setHours(n.getHours(),n.getMinutes()),l()}var m=new Date,h={$setViewValue:angular.noop},g=angular.isDefined(n.meridians)?e.$parent.$eval(n.meridians):a.meridians||r.DATETIME_FORMATS.AMPMS;this.init=function(t,i){h=t,h.$render=this.render;var r=i.eq(0),s=i.eq(1),o=angular.isDefined(n.mousewheel)?e.$parent.$eval(n.mousewheel):a.mousewheel;o&&this.setupMousewheelEvents(r,s),e.readonlyInput=angular.isDefined(n.readonlyInput)?scope.$parent.$eval(n.readonlyInput):a.readonlyInput,this.setupInputEvents(r,s)};var f=a.hourStep;n.hourStep&&e.$parent.$watch(t(n.hourStep),function(e){f=parseInt(e,10)});var v=a.minuteStep;n.minuteStep&&e.$parent.$watch(t(n.minuteStep),function(e){v=parseInt(e,10)}),e.showMeridian=a.showMeridian,n.showMeridian&&e.$parent.$watch(t(n.showMeridian),function(n){if(e.showMeridian=!!n,h.$error.time){var t=s(),i=o();angular.isDefined(t)&&angular.isDefined(i)&&(m.setHours(t),l())}else d()}),this.setupMousewheelEvents=function(n,t){var i=function(e){e.originalEvent&&(e=e.originalEvent);var n=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||n>0};n.bind("mousewheel wheel",function(n){e.$apply(i(n)?e.incrementHours():e.decrementHours()),n.preventDefault()}),t.bind("mousewheel wheel",function(n){e.$apply(i(n)?e.incrementMinutes():e.decrementMinutes()),n.preventDefault()})},this.setupInputEvents=function(n,t){if(e.readonlyInput)return e.updateHours=angular.noop,void(e.updateMinutes=angular.noop);var i=function(n,t){h.$setViewValue(null),h.$setValidity("time",!1),angular.isDefined(n)&&(e.invalidHours=n),angular.isDefined(t)&&(e.invalidMinutes=t)};e.updateHours=function(){var e=s();angular.isDefined(e)?(m.setHours(e),l("h")):i(!0)},n.bind("blur",function(){!e.validHours&&e.hours<10&&e.$apply(function(){e.hours=u(e.hours)})}),e.updateMinutes=function(){var e=o();angular.isDefined(e)?(m.setMinutes(e),l("m")):i(void 0,!0)},t.bind("blur",function(){!e.invalidMinutes&&e.minutes<10&&e.$apply(function(){e.minutes=u(e.minutes)})})},this.render=function(){var e=h.$modelValue?new Date(h.$modelValue):null;isNaN(e)?(h.$setValidity("time",!1),i.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(e&&(m=e),c(),d())},e.incrementHours=function(){p(60*f)},e.decrementHours=function(){p(60*-f)},e.incrementMinutes=function(){p(v)},e.decrementMinutes=function(){p(-v)},e.toggleMeridian=function(){p(720*(m.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(e,n,t,i){var r=i[0],a=i[1];a&&r.init(a,n.find("input"))}}}),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(e){e.put("template/timepicker/timepicker.html",'<table><tbody><tr class="text-center"><td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td><td>&nbsp;</td><td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td><td ng-show="showMeridian"></td></tr><tr><td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}"><input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2"></td><td>:</td><td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}"><input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2"></td><td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td></tr><tr class="text-center"><td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td><td>&nbsp;</td><td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td><td ng-show="showMeridian"></td></tr></tbody></table>')}]);